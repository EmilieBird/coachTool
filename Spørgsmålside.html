<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tilfældig emnevælger</title>
  <style>
#importExportContainer > div {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 12px;
  flex-wrap: wrap;
}    
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: #f9f9f9;
      color: #333;
    }
    h2 {
      text-align: center;
      margin-bottom: 10px;
    }
    #randomizeAllContainer {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 15px;
      align-items: center;
    }
    #randomizeAllContainer hr.separator {
      width: 1px;
      height: 28px;
      border: none;
      background-color: #ccc;
      margin: 0 8px;
    }
    button {
      cursor: pointer;
      padding: 6px 12px;
      font-size: 1rem;
      border: 1px solid #3498db;
      background-color: white;
      color: #3498db;
      border-radius: 4px;
      transition: background-color 0.2s ease, color 0.2s ease;
    }
    button:hover {
      background-color: #3498db;
      color: white;
    }
    .reset-button {
      border-color: #e74c3c;
      color: #e74c3c;
    }
    .reset-button:hover {
      background-color: #e74c3c;
      color: white;
    }
    #selectedResults {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 20px;
      font-weight: 600;
      font-size: 1.1rem;
    }
    #selectedResults > div {
      padding: 6px 12px;
      border: 1px solid #3498db;
      border-radius: 6px;
      min-width: 110px;
      text-align: center;
      background-color: white;
      position: relative;
    }
    #selectedResults > div:not(:last-child)::after {
      content: "|";
      position: absolute;
      right: -12px;
      top: 50%;
      transform: translateY(-50%);
      color: #aaa;
      font-weight: normal;
    }
    .wrapper {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
    }
    .list-container {
      background: white;
      border: 1px solid #ccc;
      border-radius: 8px;
      width: 250px;
      min-width: 200px;
      display: flex;
      flex-direction: column;
      padding: 10px 15px;
      box-shadow: 0 2px 4px rgb(0 0 0 / 0.1);
    }
    .list-title {
      font-weight: 700;
      margin-bottom: 10px;
      font-size: 1.2rem;
      text-align: center;
    }
    .items-box {
      flex-grow: 1;
      border: 1px solid #3498db;
      border-radius: 6px;
      padding: 8px;
      max-height: 180px;
      overflow-y: auto;
      background: #f0f8ff;
      margin-bottom: 10px;
    }
    .items-box > div {
      padding: 6px 8px;
      border-radius: 4px;
      margin-bottom: 5px;
      cursor: pointer;
      user-select: none;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.95rem;
    }
    .items-box > div.selected {
      background-color: #3498db;
      color: white;
      font-weight: 600;
    }
    .items-box > div:last-child {
      margin-bottom: 0;
    }
    .items-box > div button {
      background: transparent;
      border: none;
      color: #e74c3c;
      font-weight: 700;
      font-size: 1.2rem;
      cursor: pointer;
      padding: 0 6px 0 0;
      user-select: none;
    }
    .items-box > div button:hover {
      color: #c0392b;
    }
    .controls {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: auto;
    }
    .controls input[type="text"] {
      flex-grow: 1;
      padding: 6px 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 1rem;
    }
    #importExportContainer {
      margin-top: 40px;
      max-width: 900px;
      margin-left: auto;
      margin-right: auto;
      background: white;
      border: 1px solid #ccc;
      border-radius: 10px;
      padding: 20px 25px;
      box-shadow: 0 3px 7px rgb(0 0 0 / 0.1);
    }
    #importExportContainer h3 {
      text-align: center;
      margin-bottom: 15px;
    }
    #importExportContainer input[type="text"] {
      padding: 6px 8px;
      font-size: 1rem;
      border-radius: 4px;
      border: 1px solid #ccc;
      width: 200px;
      margin-left: 8px;
    }
    #fileInput {
      margin-left: 8px;
    }
    #importError {
      margin-top: 10px;
      color: #e74c3c;
      font-weight: 600;
      min-height: 1.2em;
      text-align: center;
    }
    @media (max-width: 800px) {
      .wrapper {
        flex-direction: column;
        align-items: center;
      }
      #selectedResults {
        flex-direction: column;
        gap: 8px;
      }
      #selectedResults > div:not(:last-child)::after {
        content: none;
      }
    }
  </style>
</head>
<body>
  <h2>Tilfældig emnevælger</h2>

  <div id="randomizeAllContainer">
    <button id="randomizeAllBtn" onclick="randomizeAll()">Bland alle</button>
    <hr class="separator" />
    <button id="1år" onclick="">1. års</button>
    <button id="2år" onclick="">2. års</button>
    <button id="3år" onclick="">3. års</button>
    <hr class="separator" />
    <button id="resetAllBtn" class="reset-button" onclick="resetAll()">Nulstil alle</button>
  </div>

  <div id="selectedResults" aria-live="polite" aria-atomic="true" aria-label="Valgte elementer fra alle lister">
    <div id="selected1">Emne: -</div>
    <div id="selected2">Målgruppe: -</div>
    <div id="selected3">Type ekspedition: -</div>
    <div id="selected4">Informationspligt: -</div>
  </div>

  <div class="wrapper">
    <div class="list-container" id="list1">
      <div class="list-title">Emner</div>
      <div class="items-box" id="items1"></div>
      <div class="controls">
        <input type="text" id="input1" placeholder="Nyt element" aria-label="Tilføj nyt element til Emner" />
        <button onclick="addItem(1)">Tilføj</button>
        <button onclick="pickRandom(1)">Vælg tilfældig</button>
        <button class="reset-button" onclick="resetList(1)">Nulstil</button>
      </div>
    </div>

    <div class="list-container" id="list2">
      <div class="list-title">Målgruppe</div>
      <div class="items-box" id="items2"></div>
      <div class="controls">
        <input type="text" id="input2" placeholder="Nyt element" aria-label="Tilføj nyt element til Målgruppe" />
        <button onclick="addItem(2)">Tilføj</button>
        <button onclick="pickRandom(2)">Vælg tilfældig</button>
        <button class="reset-button" onclick="resetList(2)">Nulstil</button>
      </div>
    </div>

    <div class="list-container" id="list3">
      <div class="list-title">Type ekspedition</div>
      <div class="items-box" id="items3"></div>
      <div class="controls">
        <input type="text" id="input3" placeholder="Nyt element" aria-label="Tilføj nyt element til Type ekspedition" />
        <button onclick="addItem(3)">Tilføj</button>
        <button onclick="pickRandom(3)">Vælg tilfældig</button>
        <button class="reset-button" onclick="resetList(3)">Nulstil</button>
      </div>
    </div>

    <div class="list-container" id="list4">
      <div class="list-title">Informationspligt</div>
      <div class="items-box" id="items4"></div>
      <div class="controls">
        <input type="text" id="input4" placeholder="Nyt element" aria-label="Tilføj nyt element til Informationspligt" />
        <button onclick="addItem(4)">Tilføj</button>
        <button onclick="pickRandom(4)">Vælg tilfældig</button>
        <button class="reset-button" onclick="resetList(4)">Nulstil</button>
      </div>
    </div>
  </div>

<div id="importExportContainer">
  <h3>Importer / Eksporter emner</h3>
  <div>
    <button onclick="exportLists()">Eksporter emner</button>
    <input type="file" id="fileInput" accept=".json" aria-label="Importer fil" style="display:none" onchange="handleFileImport(event)" />
    <button onclick="triggerFileInput()">Importer emner</button>
  </div>
  <div id="importError" role="alert" aria-live="assertive"></div>
</div>




  <script>
    // Default arrays for each list (reverted to original content exactly)
const defaultLists = {
  1: [
    'Hypertension',
    'Dyslipidæmi',
    'Iskemiske hjertekar-sygdomme',
    'Hormonelle kontraceptiva',
    'Thyroidea-sygdomme',
    'Bakterieinfektion',
    'Svampeinfektion',
    'Virusinfektion',
    'Klimakteriet',
    'KOL',
    'Migræne',
    'Obstipation',
    'Osteoporose',
    'Prostatahyperplasi',
    'ADHD',
    'Akne',
    'Allergi',
    'Astma',
    'Diarré',
    'Depression',
    'Kontakteksem',
    'Atopisk eksem',
    'Epilepsi',
    'Erektil dysfunktion',
    'Forkølelse',
    'Hoste',
    'Gigt',
    'Glaukom',
    'Skizofreni',
    'Spændings-hovedpine',
    'MOH',
    'Menstruations-smerter',
    'Dyspepsi',
    'Mavesår',
    'Refluks',
    'T1 Diabetes',
    'T2 Diabetes',
    'Urininkontinens',
    'Vitaminer og mineraler'
  ],
  2: [
    'Barn under 2 år',
    'Barn over 2 år',
    'Teenager',
    'Voksen',
    'Ældre',
    'Gravid',
    'Ammende'
  ],
  3: [
    'Recept',
    'Håndkøb'
  ],
  4: [
    'Bivirkninger',
    'Anvendelse',
    'Dosering',
    'Forsigtighedsregler',
    'Opbevaring',
    'Behandlingsvarighed',
    'Interaktioner'
  ]
};

    // Current lists (start as deep copies of defaults)
    let lists = {
      1: [...defaultLists[1]],
      2: [...defaultLists[2]],
      3: [...defaultLists[3]],
      4: [...defaultLists[4]]
    };

    // Selected indices for each list; null if none selected
    let selectedIndices = {
      1: null,
      2: null,
      3: null,
      4: null
    };

    // Render the lists to the UI
    function renderList(listNum) {
      const container = document.getElementById('items' + listNum);
      container.innerHTML = '';

      lists[listNum].forEach((item, index) => {
        const itemDiv = document.createElement('div');
        itemDiv.textContent = item;
        itemDiv.setAttribute('role', 'button');
        itemDiv.setAttribute('tabindex', '0');
        itemDiv.setAttribute('aria-pressed', selectedIndices[listNum] === index ? 'true' : 'false');

        if (selectedIndices[listNum] === index) {
          itemDiv.classList.add('selected');
        }

        itemDiv.onclick = () => selectItem(listNum, index);
        itemDiv.onkeydown = (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            selectItem(listNum, index);
          }
        };

        // Add delete button
        const delBtn = document.createElement('button');
        delBtn.textContent = '×';
        delBtn.title = 'Slet element';
        delBtn.onclick = (e) => {
          e.stopPropagation();
          deleteItem(listNum, index);
        };
        itemDiv.appendChild(delBtn);

        container.appendChild(itemDiv);
      });

      updateSelectedText();
    }

    // Select an item in a list
    function selectItem(listNum, index) {
      if (selectedIndices[listNum] === index) {
        selectedIndices[listNum] = null; // deselect if already selected
      } else {
        selectedIndices[listNum] = index;
      }
      renderList(listNum);
    }

    // Add item to a list
    function addItem(listNum) {
      const input = document.getElementById('input' + listNum);
      const value = input.value.trim();
      if (value === '') return;
      lists[listNum].push(value);
      input.value = '';
      renderList(listNum);
    }

    // Delete item from a list
    function deleteItem(listNum, index) {
      if (index === selectedIndices[listNum]) {
        selectedIndices[listNum] = null;
      } else if (index < selectedIndices[listNum]) {
        selectedIndices[listNum]--;
      }
      lists[listNum].splice(index, 1);
      renderList(listNum);
    }

    // Pick random item from a list and select it
    function pickRandom(listNum) {
      if (lists[listNum].length === 0) {
        selectedIndices[listNum] = null;
      } else {
        selectedIndices[listNum] = Math.floor(Math.random() * lists[listNum].length);
      }
      renderList(listNum);
    }

    // Reset a single list to defaults and clear selection
    function resetList(listNum) {
      lists[listNum] = [...defaultLists[listNum]];
      selectedIndices[listNum] = null;
      renderList(listNum);
    }

    // Update the selected results text area
    function updateSelectedText() {
      for (let i = 1; i <= 4; i++) {
        const selected = selectedIndices[i] !== null ? lists[i][selectedIndices[i]] : '-';
        document.getElementById('selected' + i).textContent =
          (i === 1 ? 'Emne: ' :
           i === 2 ? 'Målgruppe: ' :
           i === 3 ? 'Type ekspedition: ' :
                     'Informationspligt: ') + selected;
      }
    }

    // Randomize all lists: pick one random item from each list
    function randomizeAll() {
      for (let i = 1; i <= 4; i++) {
        pickRandom(i);
      }
    }

    // Reset all lists and selections
    function resetAll() {
      for (let i = 1; i <= 4; i++) {
        resetList(i);
      }
    }

    // Export lists as JSON and prompt user to copy
function exportLists() {
  const exportData = JSON.stringify(lists, null, 2);
  const blob = new Blob([exportData], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'lister.json';
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}


function triggerFileInput() {
  document.getElementById('fileInput').click();
}

function handleFileImport(event) {
  const file = event.target.files[0];
  const errorDiv = document.getElementById('importError');
  if (!file) {
    errorDiv.textContent = 'Ingen fil valgt.';
    return;
  }
  const reader = new FileReader();
  reader.onload = function(e) {
    try {
      const imported = JSON.parse(e.target.result);
      for (let i = 1; i <= 4; i++) {
        if (Array.isArray(imported[i])) {
          lists[i] = imported[i];
          selectedIndices[i] = null;
        } else {
          throw new Error('Forkert format i liste ' + i);
        }
      }
      errorDiv.textContent = '';
      renderAll();
    } catch (err) {
      errorDiv.textContent = 'Fejl ved import af fil: ' + err.message;
    }
  };
  reader.readAsText(file);
  event.target.value = ''; // Reset so same file can be re-selected
}


    // Render all lists
    function renderAll() {
      for (let i = 1; i <= 4; i++) {
        renderList(i);
      }
    }

    // Initial render on page load
    window.onload = () => {
      renderAll();
      updateSelectedText();
    };
  </script>
</body>
</html>
